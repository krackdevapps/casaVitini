<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Parallax Scroll Image</title>
  <style>
    body,
    html {
      margin: 0;
      padding: 0;

      scroll-behavior: smooth;
    }

  .contenedorParalax  .contenedorParalax {
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .contenedorParalax   .parallax {
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      overflow: hidden;
      flex-direction: column;
    }
    .contenedorParalax  .primera_imagen {
      transition: all 1ms linear;
    }
    .contenedorParalax  .parallax img {
      max-width: none;
      width: auto;
      height: 100%;
      /* Hace que la imagen sea más alta para el efecto de desplazamiento */
      top: 0;
      left: 50%;
      background-size: cover;

    }

    .contenedorParalax  .imagenParalaje {
      max-width: none;
      width: auto;
      height: 100vh;
      /* Hace que la imagen sea más alta para el efecto de desplazamiento */
      top: 0;
      left: 50%;
      background-size: cover;
    }

    .contenedorParalax   .parallax_comenzado {
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
      overflow: hidden;

    }
    .contenedorParalax  .texto_animado {
      background: blue;
      font-size: 15px;
      color: white;
      transform: translateX(-50%, -50%);
      z-index: 10;
      position: absolute;
      top: 90vh;
    }
    .contenedorParalax  .texto {
      background: turquoise;
      z-index: 2;
    }
  </style>
</head>

<body>

  <div class="contenedorParalax">
    <!--
    <div class="parallax">
      <img src="test.jpg" alt="Example Image" contenedor="test" class="primera_imagen">
    </div>
    <div class="texto">

      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
    </div>
    -->
    <div class="parallax_comenzado" contenedorParalaje="paralaje">
      <img src="test.jpg" alt="Example Image" class="imagenParalaje" imagenParalaje="imagen">
      <div class="texto_animado" elemento="textoAnimado">Texto animado</div>
    </div>
    <div class="texto">

      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
    </div>
    <div class="parallax_comenzado" contenedorParalaje="paralaje">
      <img src="test.jpg" alt="Example Image" class="imagenParalaje" imagenParalaje="imagen">
      <div class="texto_animado" elemento="textoAnimado">Texto animado</div>

    </div>
    <div class="texto">

      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
    </div>
    <div class="parallax_comenzado" contenedorParalaje="paralaje">
      <img src="test.jpg" alt="Example Image" class="imagenParalaje" imagenParalaje="imagen">
      <div class="texto_animado" elemento="textoAnimado">Texto animado</div>

    </div>
    <div class="texto">

      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
      Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit cumque
      facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur? Lorem ipsum dolor sit amet consectetur adipisicing elit. Ratione, nihil consequuntur. Porro, est odit
      cumque facere eos asperiores itaque voluptates exercitationem repellendus doloribus, ut minima esse et nulla sed
      aspernatur?
    </div>

    <div class="parallax_comenzado" contenedorParalaje="paralaje">
      <img src="test.jpg" alt="Example Image" class="imagenParalaje" imagenParalaje="imagen">
      <div class="texto_animado" elemento="textoAnimado">Texto animado</div>

    </div>

  </div>

  <script>
    const controladorParalaje = () => {
      // Primero efecto
      /*
      const parallax = document.querySelector('[contenedor=test]');
      const scrollPosition = window.pageYOffset / 2;

  

      console.log("scrollPosition", scrollPosition)
      parallax.style.transform = 'translate3d(0, ' + scrollPosition + 'px ,0)';

      */

      // Segundo bloque
      const contenedoresPalaraje = document.querySelectorAll("[contenedorParalaje]")
      contenedoresPalaraje.forEach((contenedorParalaje) => {
        const parallaxContainer2 = contenedorParalaje;
        const parallaxImage2 = contenedorParalaje.querySelector('[imagenParalaje]');
        const textoAnimado = contenedorParalaje.querySelector('[elemento=textoAnimado]');

        const containerRect2 = parallaxContainer2.getBoundingClientRect();

        const scrollPosition2 = window.pageYOffset;
        const parallaxTop2 = parallaxContainer2.offsetTop;
        const parallaxHeight2 = parallaxContainer2.offsetHeight;
        const parallaxVisibleHeight2 = Math.min(window.innerHeight, parallaxTop2 + parallaxHeight2) - Math.max(0, containerRect2.top);
        const conCero = Math.min(window.innerHeight, parallaxTop2 + parallaxHeight2) - (containerRect2.top + parallaxHeight2);

        const translateY_2 = (scrollPosition2 - containerRect2.top) * 0.5;
        const maxTranslateY = parallaxVisibleHeight2 - parallaxHeight2;

        const translateY = Math.max(-maxTranslateY, Math.min(0, translateY_2)) / 2;
        const translateY_sincero = Math.max(-maxTranslateY, translateY_2) / 2;


        if (containerRect2.top < 0 && containerRect2.bottom < window.innerHeight) {
          parallaxImage2.style.transform = 'translate3d(0 ,' + (conCero / 2) + 'px ,0)';
          if (textoAnimado) {
            textoAnimado.style.transform = 'translate3d(0 ,-' + (conCero) + 'px ,0)';
          }

          console.log("imagen yendose")
        } else if (containerRect2.top < window.innerHeight && containerRect2.bottom > 0) {
          parallaxImage2.style.transform = 'translate3d(0 ,-' + translateY + 'px ,0)';
          if (textoAnimado) {
            textoAnimado.style.transform = 'translate3d(0 ,' + (translateY * 2) + 'px ,0)';
          }

 

          console.log("imagen viniendo")
        } else {
          parallaxImage2.style.transform = 'translateY(0)';
          console.log("imagen no visible antes")
        }

      })


    }
    window.addEventListener('scroll', controladorParalaje);
    controladorParalaje();
  </script>
</body>

</html>